# 迷你实验室：启用 Azure AD 自助式密码重置

Azure Active Directory（Azure AD）自助式密码重置 (SSPR) 使用户无需管理员或帮助台即可更改或重置密码。如果用户的帐户被锁定或忘记了密码，则可按照提示自行解锁并恢复工作。此功能可在用户无法登录其设备或应用程序时减少帮助台呼叫量和对工作效率的影响。

本主题演示如何启用自助式密码重置。 

* 为一组 Azure AD 用户启用自助式密码重置

* 配置身份验证方法和注册选项

* 以用户身份测试 SSPR 流程

## 前提条件

预计该实验室将作为 **“讲师演示”** 运行，因为要完成此微型实验室，你需要以下资源和特权：

* 至少启用了试用版许可证的有效 Azure AD 租户。 

* 具有全局管理员特权的帐户。

* 具有知道密码的非管理员用户，例如 testuser。可以在此迷你实验室中使用此帐户测试最终用户的 SSPR 体验。 

* 该非管理员用户所属的组，例如 SSPR-Test-Group。你可以在本小型实验室中为此组启用 SSPR。 

## 启用自助式密码重置

Azure AD 可让你为 `None`、`Selected`或`All users` 启用 SSPR。借助该粒度功能，可选择一部分用户来测试 SSPR 注册流程和工作流。熟悉该过程并能与更广泛的用户组交流需求后，可选择其他用户组来启用 SSPR。也可为 Azure AD 租户中的每个人启用 SSPR。

在本迷你实验室中，为测试组中的一组用户配置 SSPR。在以下示例中，我们将使用“`SSPR-Test-Group`”组。根据需要提供自己的 Azure AD 组：

1. 使用具有全局管理员权限的帐户登录至 [Azure 门户](https://portal.azure.com/)。

1. 搜索并选择 **“Azure Active Directory”**，然后从左侧菜单中选择 **“密码重置”**。

1. 在 **“属性”** 页面上，在已启用的 `Self service` 密码重置选项下，选择 **“选择组”**。

1. 搜索并选择 Azure AD 组（例如 *SSPR-Test-Group*），然后选择 **“选择”**。

    [![启用自助式密码重置](../../Linked_Image_Files/how_to_setup_sspr_image1.png)](https://docs.microsoft.com/zh-cn/azure/active-directory/authentication/media/tutorial-enable-sspr/enable-sspr-for-group.png#lightbox)

    支持使用嵌套组作为较广泛 SSPR 部署的一部分。确保为所选组中的用户分配了适当的许可证。目前不会针对这些许可要求运行验证过程。

1. 要为所选用户启用 SSPR，请选择 **“保存”**。

## 选择身份验证方法和注册选项

当用户需要解锁帐户或重置密码时，系统会提示他们选择其他确认方法。此附加身份验证因素可确保仅完成批准的 SSPR 事件。 
    
>你可以根据用户提供的注册信息选择允许使用的身份验证方法。

1. 在左侧菜单的 **“身份验证方法”** 页面，将 **“重置所需的方法数”** 设置为 *“1”*。

    为提高安全性，可增加 SSPR 所需的身份验证方法数。

1. 选择组织希望允许的 **“用户可以使用的方法”**。对于迷你实验室，请选中相应的框以启用以下方法：

    - *移动应用通知*

    - *移动应用验证码*

    - *电子邮件*

    - *移动电话*

    - *办公电话*

1. 要应用身份验证方法，请选择 **“保存”**。

## 配置用户下次登录时的注册提示

用户必须先注册其联系信息，然后才能解锁其帐户或重置密码。此联系信息用于前面步骤中配置的不同身份验证方法。

管理员可手动提供此联系信息，或者用户可转至注册门户自行提供此信息。在此迷你实验室中，配置用户下次登录时提示其进行注册。

1. 在左侧菜单的 **“注册”** 页面上，对 **“要求用户在登录时注册”** 选择“是”。

2. 请确保联系信息保持最新。如果 SSPR 事件启动时联系信息已过时，则用户可能无法解锁其帐户或重置其密码。

1. 将 **“要求用户重新确认其身份验证信息之前的天数”** 设置为 *“180”*。

1. 要应用注册设置，请选择 **“保存”**。

## 配置通知和自定义

为使用户了解帐户活动，可配置为在 SSPR 事件发生时发送电子邮件通知。这些通知可涵盖普通用户帐户和管理员帐户。对于管理员帐户，当使用 SSPR 重置特权管理员帐户密码时，可另行发送该通知。

1. 在左侧菜单的 **“通知”** 页面上，配置以下选项：

    - 将 **“通知用户密码重置选项”** 设置为 *“是”*。

    - 将 **“当其他管理员重置其密码时通知所有管理员”** 设置为 *“是”*。

1. 要应用通知首选项，请选择 **“保存”**。

## 测试自助式密码重置

启用和配置 SSPR 后，使用在上一部分中选择的组中的用户（例如 Test-SSPR-Group）测试 SSPR 进程。在以下示例中，使用了 testuser 帐户。提供你自己的用户帐户，该帐户属于你在此迷你实验室的第一部分为 SSPR 启用的组。

>**注意**
在测试自助式密码重置时，请使用非管理员帐户。始终为管理员启用自助式密码重置功能，并要求管理员使用两种身份验证方法重置其密码。

1. 要查看手动注册过程，请在 InPrivate 或隐身模式下打开一个新浏览器窗口，然后浏览至 [https://aka.ms/ssprsetup](https://aka.ms/ssprsetup)。下次登录时，应将用户定向到此注册门户。

1. 使用非管理员测试用户（例如 `testuser`）登录，并注册身份验证方法的联系信息。

1. 完成后，选择标记为 **“看上去不错”** 的按钮，然后关闭浏览器窗口。

1. 在 InPrivate 或隐身模式下打开新浏览器窗口，然后浏览至 [https://aka.ms/sspr](https://aka.ms/sspr)。

1. 输入你的非管理员测试用户的帐户信息（例如 `testuser`）、CAPTCHA 中的字符，然后选择 **“下一步”**。

    ![输入用户帐户信息以重置密码](../../Linked_Image_Files/how_to_setup_sspr_image2.png)

1. 请按照验证步骤重置密码。完成后，你会收到一封电子邮件通知，告知你密码已重置。
